(window.webpackJsonp_7791ba97_d454_4f5a_acbc_65bb23b136df_0_0_1=window.webpackJsonp_7791ba97_d454_4f5a_acbc_65bb23b136df_0_0_1||[]).push([[11],{p4uR:function(e,t,a){"use strict";a.r(t);var r,n=a("cDcd"),o=a("NJtC"),s=a("5wdw"),l=a("O5Vo"),c=a("nXxM"),m=a("E2g8"),i=a("Mg8E"),p=a("nPZ+"),u=a("2o7q"),d=a("AsBa"),f=a("oJku"),E=a("UKGb"),v=(a("6k7F"),a("Bwa7"),a("lYrR"),a("HLtT"),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),h=function(){return(h=Object.assign||function(e){for(var t,a=1,r=arguments.length;a<r;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},I=[{key:"Yes",text:"Active"},{key:"No",text:"Inactive"}],y=[],N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isModal:!1,formItem:{Id:0,Title:"",LeaveType:{Id:0,Title:""},ApproverName:[],StartDate:"",EndDate:"",LeaveReason:"",Status:"Sent",IsActiveRecord:"Yes"},allLeave:[],LeaveTypeGroup:[],ApproverName:[],TitleError:"",LeaveTypeError:"",StartDateError:"",EndDateError:"",LeaveReasonError:"",fileError:"",ApproverNameError:"",isEdit:t.props.isEdit,NewfileAttchamnetsArray:[],displayAttachment:""},t.getAllRecords=function(){var e=[],a=o.a.getLargeListItems("LeaveType",["Id","Title"],[],"IsActiveRecord eq 'Yes'",5e3,"Title",!0).then(function(t){e=t,Object(u.e)("Success: getAllRecords().getLargeListItems().Function"),m.Promise.resolve()}).catch(function(e){Object(u.e)("Exception: getAllRecords().getLargeListItems().Function"),m.Promise.resolve()});return m.Promise.all([a]).then(function(a){return{LeaveTypeGroupData:e,allLeaveData:t.props.allLeave}}).catch(function(e){return Object(u.e)("Error in getting all Records"),Object(u.a)("Advance","Advance","getAllRecords",e),!1})},t.fileUploadChange=function(e){var a=e.target.files.length>0?e.target.files[0].name:"";a=""==a?a:a.split(".")[a.split(".").length-2]+"__"+Object(u.g)()+"__."+a.split(".")[a.split(".").length-1],t.setState(function(e){return h({},e,{check:!0,isAttached:!0})})},t.configureForm=function(e){if(Object(u.e)("All Apply For Jobs Records -"),Object(u.e)(e),0!=e&&(t.setState({allLeave:e.allLeaveData,LeaveTypeGroup:e.LeaveTypeGroupData}),t.state.isEdit)){var a=t.props.editItemValues.Id,r=null;e.allLeaveData.forEach(function(e){e.Id==a&&(r={Id:a,Title:e.Title,ApproverName:e.ApproverName,LeaveType:d.a.IsNullOrEmpty(e.LeaveType)?"":e.LeaveType,StartDate:e.StartDate,EndDate:e.EndDate,LeaveReason:e.LeaveReason,Status:e.Status,IsActiveRecord:e.IsActiveRecord})});d.a.IsNullOrEmpty(r.ApproverName)||r.ApproverName.map(function(e){return{Id:e.Id,Title:e.Title,UserName:e.UserName}});var n="";E.b.web.lists.getByTitle("LeaveRequest").items.getById(r.Id).attachmentFiles.select("FileName","ServerRelativeUrl").get().then(function(e){e.length>0&&(e.forEach(function(e){n+="<li><a href='"+e.ServerRelativeUrl+"' target='_blank' rel='nofollow'>"+e.FileName+"</a></li>"}),n="<ul id='ulDispFileList'>"+n+"</ul>",t.setState({displayAttachment:n}))}),t.setState({formItem:{Id:r.Id,Title:r.Title,ApproverName:r.ApproverName,LeaveType:r.LeaveType,StartDate:r.StartDate,EndDate:r.EndDate,LeaveReason:r.LeaveReason,Status:r.Status,IsActiveRecord:r.IsActiveRecord},TitleError:"",LeaveTypeError:"",StartDateError:"",EndDateError:"",LeaveReasonError:"",fileError:"",ApproverNameError:""})}},t.validateApplyLeaveDetails=function(){t.setState({TitleError:"",LeaveTypeError:"",StartDateError:"",EndDateError:"",LeaveReasonError:"",fileError:"",ApproverNameError:""});var e=!0,a=t.state.formItem;return d.a.IsNullOrEmpty(a.Title)&&(t.setState(function(e){return h({},e,{TitleError:"Please enter Leave"})}),e=!1),d.a.IsNullOrEmpty(a.LeaveType)&&(t.setState(function(e){return h({},e,{LeaveTypeError:"Please Select LeaveType"})}),e=!1),t.isUndefinedOrNull(a.ApproverName)&&(t.setState(function(e){return h({},e,{ApproverNameError:"Please Enter Manager"})}),e=!1),d.a.IsNullOrEmpty(a.StartDate)&&(t.setState(function(e){return h({},e,{StartDateError:"Please enter Start Date"})}),e=!1),d.a.IsNullOrEmpty(a.EndDate)&&(t.setState(function(e){return h({},e,{EndDateError:"Please enter End Date"})}),e=!1),d.a.IsNullOrEmpty(a.LeaveReason)&&(t.setState(function(e){return h({},e,{LeaveReasonError:"Please enter Leave reason"})}),e=!1),e},t.saveLeaveDetails=function(){t.props.LoaderControl(!0);var e={Title:t.state.formItem.Title,LeaveTypeId:t.state.formItem.LeaveType.Id,ApproverNameId:{results:t.state.formItem.ApproverName.map(function(e){return e.Id})},StartDate:t.state.formItem.StartDate,EndDate:t.state.formItem.EndDate,LeaveReason:t.state.formItem.LeaveReason,Status:t.state.formItem.Status,IsActiveRecord:t.state.formItem.IsActiveRecord};t.validateApplyLeaveDetails()?t.props.isEdit?o.a.updateListItemById("LeaveRequest",t.state.formItem.Id,e).then(function(){y?E.b.web.lists.getByTitle("LeaveRequest").items.getById(t.state.formItem.Id).attachmentFiles.addMultiple(y).then(function(e){t.props.onCancel(!0),t.props.ShowSucErrPopup("Success","Record Updated Successfully.","update"),t.props.LoaderControl(!1)}):(t.props.onCancel(!0),t.props.ShowSucErrPopup("Success","Record Updated Successfully.","update"),t.props.LoaderControl(!1))}).catch(function(e){t.props.LoaderControl(!1),t.props.ShowSucErrPopup("Error","Something went wrong. Please contact to your administrator","error",t.onCancelClick)}):o.a.addListItem("LeaveRequest",e).then(function(e){y?E.b.web.lists.getByTitle("LeaveRequest").items.getById(e.Id).attachmentFiles.addMultiple(y).then(function(e){t.props.onCancel(!0),t.props.ShowSucErrPopup("Success","Record Added Successfully.","add"),t.props.LoaderControl(!1)}):(t.props.onCancel(!0),t.props.ShowSucErrPopup("Success","Record Added Successfully.","add"),t.props.LoaderControl(!1))}).catch(function(e){t.props.LoaderControl(!1),t.props.ShowSucErrPopup("Error","Something went wrong. Please contact to your administrator","error",t.onCancelClick)}):t.props.LoaderControl(!1)},t._onChangeManagerPerson=function(e){for(var a=e.map(function(e){return{Id:e.id,Title:e.text,UserName:e.secondaryText}}),r=[],n=new Map,o=0,s=a;o<s.length;o++){var l=s[o];n.has(l.Id)||(n.set(l.Id,!0),r.push(l))}t.setState(function(e){return{formItem:h({},e.formItem,{ApproverName:r})}})},t.onCancelClick=function(){t.setState({TitleError:"",LeaveTypeError:"",StartDateError:"",EndDateError:"",LeaveReasonError:"",fileError:"",ApproverNameError:""}),t.props.onCancel(!0)},t.isUndefinedOrNull=function(e){return void 0===e||null==e||""==e},t.onDropdownLeaveType=function(e,a,r){var n={Id:a.key,Title:a.text};t.setState(function(e){return h({},e,{formItem:h({},e.formItem,{LeaveType:n}),LeaveTypeError:""})})},t.onStartdateSelect=function(e){t.setState({formItem:h({},t.state.formItem,{StartDate:e.toString().substring(0,15)})})},t.onEnddateSelect=function(e){t.setState({formItem:h({},t.state.formItem,{EndDate:e.toString().substring(0,15)})})},t}return v(t,e),t.prototype.componentDidMount=function(){var e=this;this.getAllRecords().then(function(t){e.configureForm(t)})},t.prototype.addNewAttachmentsFiles=function(e){var t=e.target.files;console.log(t),y=[];for(var a=0;a<t.length;a++){var r=t[a].name;console.log(r);var n=t[a],o=new FileReader;o.onload=function(e){return function(t){y.push({name:e.name,content:t.target.result})}}(n),o.readAsArrayBuffer(n)}console.log(this.state.NewfileAttchamnetsArray)},t.prototype.render=function(){var e=this;return n.createElement(n.Fragment,null,n.createElement("h1",{className:"sub-head-fixed"},"Apply For Leave"),n.createElement("div",{className:"form-container"},n.createElement("div",{className:"form-row"},n.createElement("div",{className:"col-md-4"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Leave Title",n.createElement("span",{className:"mandatory"})),n.createElement(l.a,{value:this.state.formItem.Title,placeholder:"Enter Leave",onChange:function(t,a){a.length<u.c&&e.setState(function(e){return{formItem:h({},e.formItem,{Title:a,TitleError:""})}})},className:"form-control"}),n.createElement("span",{className:"required"},this.state.TitleError))),n.createElement("div",{className:"col-md-4"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Leave Type",n.createElement("span",{className:"mandatory"})),n.createElement(s.a,{placeholder:"Select Leave Type",options:Object(u.f)(this.props.isEdit&&0==this.state.LeaveTypeGroup.filter(function(t){return t.Id==e.state.formItem.LeaveType.Id}).length?[this.state.formItem.LeaveType].concat(this.state.LeaveTypeGroup):this.state.LeaveTypeGroup),className:"form-control",onChange:this.onDropdownLeaveType,selectedKey:this.state.formItem.LeaveType.Id}),n.createElement("span",{className:"required"},this.state.LeaveTypeError))),n.createElement("div",{className:"col-md-4"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Manager Name",n.createElement("span",{className:"mandatory"})),n.createElement(p.a,{context:this.props.context,personSelectionLimit:10,showtooltip:!0,defaultSelectedUsers:d.a.IsNullOrEmpty(this.state.formItem.ApproverName)?[]:this.state.formItem.ApproverName.map(function(e){return e.UserName}),peoplePickerCntrlclassName:"form-control",tooltipMessage:"Search User...",ensureUser:!0,placeholder:d.a.IsNullOrEmpty(this.state.formItem.ApproverName)?"Select Users...":"",onChange:function(t){for(var a=t.map(function(e){return{Id:e.id,Title:e.text,UserName:e.secondaryText}}),r=[],n=new Map,o=0,s=a;o<s.length;o++){var l=s[o];n.has(l.Id)||(n.set(l.Id,!0),r.push(l))}e.setState(function(e){return{formItem:h({},e.formItem,{ApproverName:r})}})},showHiddenInUI:!1,principalTypes:[p.b.User],resolveDelay:1e3}),n.createElement("span",{className:"required"},this.state.ApproverNameError))),n.createElement("div",{className:"col-md-4"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Start Date",n.createElement("span",{className:"mandatory"})),n.createElement(f.a,{className:"form-control form-group-control",borderless:!0,formatDate:d.a.DateFormat,ariaLabel:"Enter Start Date",value:d.a.IsNullOrEmpty(this.state.formItem.StartDate)?null:new Date(this.state.formItem.StartDate),onSelectDate:this.onStartdateSelect,allowTextInput:!1,disableAutoFocus:!0}),n.createElement("span",{className:"required"},this.state.StartDateError))),n.createElement("div",{className:"col-md-4"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"End Date",n.createElement("span",{className:"mandatory"})),n.createElement(f.a,{className:"form-control form-group-control",formatDate:d.a.DateFormat,ariaLabel:"Enter End Date",value:d.a.IsNullOrEmpty(this.state.formItem.EndDate)?null:new Date(this.state.formItem.EndDate),onSelectDate:this.onEnddateSelect,allowTextInput:!1,disabled:d.a.IsNullOrEmpty(this.state.formItem.StartDate),minDate:d.a.IsNullOrEmpty(this.state.formItem.StartDate)?null:new Date(this.state.formItem.StartDate)}),n.createElement("span",{className:"required"},this.state.EndDateError))),n.createElement("div",{className:"col-md-4"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Leave Reason",n.createElement("span",{className:"mandatory"})),n.createElement(l.a,{value:this.state.formItem.LeaveReason,placeholder:"Enter Leave Reason",onChange:function(t,a){a.length<u.c&&e.setState(function(e){return{formItem:h({},e.formItem,{LeaveReason:a,LeaveReasonError:""})}})},multiline:!0,className:"form-control"}),n.createElement("span",{className:"required"},this.state.LeaveReasonError))),n.createElement("div",{className:"col-md-4"},n.createElement("div",{className:"form-group"},n.createElement("label",null,n.createElement("label",null,"Supporting Documents"),n.createElement("span",{className:"mandatory"})),n.createElement("input",{className:"form-control",type:"file",multiple:!0,id:"fileAddNewAttachments",onChange:this.addNewAttachmentsFiles.bind(this)}),n.createElement("span",{className:"required"},this.state.fileError))),n.createElement("div",{className:"col-md-4"},n.createElement("div",{className:"form-group"},!!this.state.displayAttachment&&n.createElement(n.Fragment,null,n.createElement("label",null,n.createElement("label",null,n.createElement("b",null,"All Attachments: "))),n.createElement("label",{dangerouslySetInnerHTML:{__html:this.state.displayAttachment}})))),this.props.isEdit&&n.createElement(n.Fragment,null,"No"==this.props.editItemValues.IsActiveRecord&&n.createElement(n.Fragment,null,n.createElement("div",{className:"col-12 col-sm-6"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Status",n.createElement("span",{className:"mandatory"})),n.createElement(i.a,{selectedKey:this.state.formItem.IsActiveRecord,options:I,onChange:function(t,a){return e.setState(function(e){return{formItem:h({},e.formItem,{IsActiveRecord:a.key})}})},className:"form-control inlineflex"}),n.createElement("span",{className:"required"}))))),n.createElement("div",{className:"two-col-partition-container"},n.createElement("div",{className:"btn-form-box"},n.createElement(c.a,{text:"Cancel",className:"btn btn-secondary",onClick:function(){return e.onCancelClick()}}),n.createElement(c.a,{text:this.props.isEdit?"Update":"Save",className:"btn  btn-primary",onClick:function(){return e.saveLeaveDetails()}}))))))},t}(n.Component);t.default=N}}]);